<%
  activities = task.activities.reload.recent.limit(10)
%>
<div id="task-activities-<%= task.id %>">
  <% if activities.any? %>
    <div style="display:flex;flex-direction:column;gap:0;position:relative">
      <%# Vertical connector line %>
      <div style="position:absolute;left:13px;top:14px;bottom:14px;width:1px;background:rgba(255,255,255,0.04)"></div>

      <% activities.each do |activity| %>
        <%
          # Determine icon style by activity type
          if activity.actor_type == "agent"
            icon = { bg: "rgba(251,191,36,0.12)", border: "rgba(251,191,36,0.2)", color: "#fbbf24", symbol: "ðŸ¤–", size: "11px" }
          elsif activity.action == "created"
            icon = { bg: "rgba(96,165,250,0.12)", border: "rgba(96,165,250,0.2)", color: "#60a5fa", symbol: "+", size: "12px" }
          elsif activity.action == "moved"
            icon = { bg: "rgba(167,139,250,0.12)", border: "rgba(167,139,250,0.2)", color: "#a78bfa", symbol: "â†’", size: "12px" }
          elsif activity.action == "updated" && activity.field_name == "priority"
            icon = { bg: "rgba(52,211,153,0.12)", border: "rgba(52,211,153,0.2)", color: "#34d399", symbol: "!", size: "12px" }
          elsif activity.action == "updated"
            icon = { bg: "rgba(251,191,36,0.12)", border: "rgba(251,191,36,0.2)", color: "#fbbf24", symbol: "âœŽ", size: "11px" }
          else
            icon = { bg: "rgba(255,255,255,0.06)", border: "rgba(255,255,255,0.08)", color: "#666", symbol: "â€¢", size: "12px" }
          end
        %>
        <div style="display:flex;align-items:flex-start;gap:10px;padding:8px 0;position:relative">
          <div style="width:26px;height:26px;min-width:26px;border-radius:50%;background:<%= icon[:bg] %>;border:1px solid <%= icon[:border] %>;display:flex;align-items:center;justify-content:center;font-size:<%= icon[:size] %>;font-weight:700;color:<%= icon[:color] %>;z-index:1">
            <%= icon[:symbol] %>
          </div>
          <div style="flex:1;padding-top:2px">
            <div style="font-size:12px;font-weight:500;color:#999;line-height:1.4">
              <%= activity.description %>
            </div>
            <div style="font-size:10px;font-weight:500;color:#333;margin-top:2px">
              <%= time_ago_in_words(activity.created_at) %> ago
            </div>
          </div>
        </div>
      <% end %>
    </div>
  <% else %>
    <div style="font-size:12px;font-weight:500;color:#444;font-style:italic">No activity yet</div>
  <% end %>
</div>
